<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><title></title>

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/DUI.js"></script>
    <script type="text/javascript" src="js/Stream.js"></script>
</head>

<body>

<h1>DUI.Stream: Better living through MXHR</h1>

<table style="width: 100%">
<tr>
    <td id="stream" valign="top" style="width: 50%; border: 3px solid green"></td>
    <td id="normal" valign="top" style="width: 50%; border: 3px solid blue"></td>
</tr>
</table>

<script type="text/javascript">

//COME WITH ME IF YOU WANT TO LIVE
var s = new DUI.Stream();

s.listen('image/gif', function(payload) {
    $j('#stream').append('<object type="image/gif" data="data:image/gif;base64,' + payload + '" width="20" height="20"></object>');
});

s.listen('complete', function() {
    $j('#stream').append('<p>Stream took: ' + ((new Date).getTime() - streamStart) + 'ms</p>');
    
    var normalStart = (new Date).getTime();
    var imgs = '';
    for (var i = 0; i < 300; i++) {
        imgs += '<img src="img/32x32-digg-guy.gif?nocache=' + (new Date).getTime() * Math.random() +    '" width="20" height="20" />';
    }
    
    $j('#normal').append(imgs);
    
    $j('img:last', '#normal').load(function() {
        $j('#normal').append('<p>Normal, uncached took: ' + ((new Date).getTime() - normalStart) + 'ms</p>');
    });
});

var streamStart = (new Date).getTime();
s.load('testStreamData.php?size=512&payloads=5');

</script>


</body>

</html>
